<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>Smash Ultimate Material Research</title>

      
      

      <!-- CSS -->
      
      <link rel="stylesheet" href="https://scanmountgoat.github.io/Smush-Material-Research/book.css">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
      

      
      
    </head>

    <body>
        <div class="menu">
            
            
            <nav role="navigation">
                <ul>
                    
                        
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;introduction&#x2F;">
                                    
                                    Introduction
                                </a>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;">
                                    
                                    Textures
                                </a>
                                
                                    <ul>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;col&#x2F;">
                                                    
                                                    Col (Texture0, Texture1)
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;prm&#x2F;">
                                                    
                                                    PRM (Texture6)
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;nor&#x2F;">
                                                    
                                                    NOR (Texture4)
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;emi&#x2F;">
                                                    
                                                    Emi (Texture5, Texture14)
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;difcube&#x2F;">
                                                    
                                                    Diffuse Cube (Texture8)
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;specularcube&#x2F;">
                                                    
                                                    Specular Cube (Texture7)
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;textures&#x2F;gamma&#x2F;">
                                                    
                                                    Gamma Correction
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;vertex_attributes&#x2F;">
                                    
                                    Vertex Attributes
                                </a>
                                
                                    <ul>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;vertex_attributes&#x2F;vertex-attributes&#x2F;">
                                                    
                                                    Vertex Attributes
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;vertex_attributes&#x2F;texturecoordinates&#x2F;">
                                                    
                                                    Texture Coordinates
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;vertex_attributes&#x2F;colorsets&#x2F;">
                                                    
                                                    Color Sets - WIP
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;">
                                    
                                    Materials
                                </a>
                                
                                    <ul>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;material-transitions&#x2F;">
                                                    
                                                    Material Transitions
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;transparency&#x2F;">
                                                    
                                                    Transparency
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;skin-materials&#x2F;">
                                                    
                                                    Skin Materials
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;hair-materials&#x2F;">
                                                    
                                                    Hair Materials - WIP
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;model-brightness&#x2F;">
                                                    
                                                    Model Brightness
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;materials&#x2F;renormal&#x2F;">
                                                    
                                                    Renormal Materials
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;post_processing&#x2F;">
                                    
                                    Post Processing
                                </a>
                                
                                    <ul>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;post_processing&#x2F;colorgradinglut&#x2F;">
                                                    
                                                    Color Grading Lut
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;post_processing&#x2F;snapshot&#x2F;">
                                                    
                                                    Snapshot Filters - WIP
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;renders&#x2F;">
                                    
                                    Renders
                                </a>
                                
                                    <ul>
                                        
                                            <li class="active">
                                                <a href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;renders&#x2F;albedo-recoloring&#x2F;">
                                                    
                                                    Albedo Recoloring
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                        <a href="https://github.com/ScanMountGoat/Smush-Material-Research"><i class="fa fa-github"></i> GitHub Repository</a>
                    
                </ul>
            </nav>
            
            
        </div>

        <div class="page">
            <div class="page__header">
                <div class="menu-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                
                <span class="search-icon">ðŸ”Ž</span>
                
            </div>

            <div class="page__content">
                
                <div class="search-container">
                    <input id="search" type="search" placeholder="Search..">
                    <div class="search-results">
                        <div class="search-results__header"></div>
                        <ul class="search-results__items"></ul>
                    </div>
                </div>
                
                <div class="book-content">
                    
    <h1>Albedo Recoloring</h1>
    <style>
    #imgCanvas {
        width: 50%;
    }
</style>
<p>Renders can be recolored by extracting the lighting information and then applying a new albedo color.
If the same color is used for the previous and new albedo, the final result is unchanged.
The render will accurately match the selected new albedo color without the need for a levels/curves adjustment.
This also preserves the color variations in the original lighting unlike automatic recoloring or similar HSL techniques.</p>
<p><canvas id="imgCanvas"></canvas></p>
<p>Select a new albedo color to see the armor on the render update in real time.</p>
<form>
    <label for="albedo">Previous Albedo</label>
    <input type="color" id="albedo" name="albedo" value="#B0AFA9">
    <label for="newAlbedo">New Albedo</label>
    <input type="color" id="newAlbedo" name="newAlbedo" value="#B0AFA9">
</form>
<h2 id="details">Details&nbsp;<a class="anchor" href="#details">&#xE732;</a></h2>
<p>This technique approximates well how fully metallic objects are rendered in game (PRM red channel is 1.0) because
metallic objects have no diffuse component. The results for non metallic materials will still match the desired overall luminance,
but there may be discolorations. Potential fixes are discussed in the image editing section.</p>
<h3 id="how-to-determine-albedo-color">How to Determine Albedo Color&nbsp;<a class="anchor" href="#how-to-determine-albedo-color">&#xE732;</a></h3>
<p>The albedo values can be copied from the Col maps for non skin materials. For skin materials, copy paste the values from
SSBH Editor's albedo rendering mode by taking a screenshot or using a screen color picker. This takes into account the fake subsurface scattering effect applied in game.
See <a href="skin_materials">Skin Materials</a> for details.</p>
<h3 id="example-code">Example Code&nbsp;<a class="anchor" href="#example-code">&#xE732;</a></h3>
<pre data-lang="c" style="background-color:#eff1f5;color:#4f5b66;" class="language-c "><code class="language-c" data-lang="c"><span style="color:#a7adba;">// Metals
</span><span>final = albedo x specular_light
</span><span>
</span><span style="color:#a7adba;">// Non Metals
</span><span>final = (albedo x diffuse_light) + (specular_light)
</span><span>
</span><span style="color:#a7adba;">// Recoloring Metals
</span><span>lighting = final / col_rgb
</span><span>recolored = lighting * new_albedo
</span><span>
</span><span style="color:#a7adba;">// Recoloring Non Metals
</span><span>lighting = final / previous_albedo
</span><span>recolored = lighting * new_albedo
</span></code></pre>
<h2 id="albedo-recoloring-in-an-image-editor">Albedo Recoloring in an Image Editor&nbsp;<a class="anchor" href="#albedo-recoloring-in-an-image-editor">&#xE732;</a></h2>
<img src="gimp_2_1.jpg" height="auto" width="auto">
The arrangement of the layers depends on the image editor being used. The above image is from Gimp 2.1.
If using layer groups, make sure the blend mode for the group is set to Pass through.
<p>The order is important when working in 8 bits per channel images. Multiplying first mitigates potential clipping issues
from the divide layer.
If the effect still introduces noticeable banding artifacts, try switching to 16 bits per channel.</p>
<h3 id="gimp-photoshop-krita">Gimp, Photoshop, Krita&nbsp;<a class="anchor" href="#gimp-photoshop-krita">&#xE732;</a></h3>
<ul>
<li>Recolor Group + Mask (Pass through)</li>
<li>Previous Albedo (Divide)</li>
<li>New Albedo (Multiply)</li>
<li>Base Render</li>
</ul>
<p>If the final result is very discolored, double check the color used for the original albedo.
Another copy of the new albedo layer can be added to even out the color with the opacity adjusted as needed.
The color blend mode should be available in most image editors.</p>
<ul>
<li>Recolor Group + Mask (Pass through)</li>
<li>New Albedo (Color)</li>
<li>Previous Albedo (Divide)</li>
<li>New Albedo (Multiply)</li>
<li>Base Render</li>
</ul>
<h3 id="affinity-photo">Affinity Photo&nbsp;<a class="anchor" href="#affinity-photo">&#xE732;</a></h3>
<p>If the image editor doesn't support the divide blending mode, invert the previous albedo color and set the layer blend
mode to color dodge. This performs the same operation as divide.</p>
<ul>
<li>Recolor Group (Pass through)</li>
<li>Mask</li>
<li>1 - Previous Albedo (Color Dodge)</li>
<li>New Albedo (Multiply)</li>
<li>Base Render</li>
</ul>
<h2 id="examples">Examples&nbsp;<a class="anchor" href="#examples">&#xE732;</a></h2>
<div class="col-lg-7">
    <img class="img-fluid" src="corrin_m_c04.jpg">
</div>
<h2 id="further-reading">Further Reading&nbsp;<a class="anchor" href="#further-reading">&#xE732;</a></h2>
<p>For custom renders, there are more render passes available that can perfectly recreate the final render.
See Blender's <a href="https://docs.blender.org/manual/en/latest/render/layers/passes.html#combining"
    target="_blank">AOV Documentation</a>
for details. Remember to composite AOVs in 32 bit floating point with linear gamma (1.0) for proper blending and to
avoid clipping!</p>

<script type="module" src=https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;javascript&#x2F;albedo_recoloring.js></script>

                </div>
            </div>

            <div class="prev-link">
                
    
        
        
        <a class="previous" href="https:&#x2F;&#x2F;scanmountgoat.github.io&#x2F;Smush-Material-Research&#x2F;renders&#x2F;"><</a>
    

            </div>

            <div class="next-link">
                
    
        
        
        
        
            
            
            
        
            
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        
            
            
            
                
            
                
            
                
            
        
            
            
            
                
            
                
            
                
            
                
            
                
            
                
            
        
            
            
            
                
            
                
            
        
            
            
            
                
                    
                
            
        
    

            </div>
        </div>

        
            
            <script type="text/javascript" src="https://scanmountgoat.github.io/Smush-Material-Research/elasticlunr.min.js"></script>
            <script type="text/javascript" src="https://scanmountgoat.github.io/Smush-Material-Research/search_index.en.js"></script>
            
            <script type="text/javascript" src="https://scanmountgoat.github.io/Smush-Material-Research/book.js"></script>
        
    </body>

</html>
